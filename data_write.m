function data_write( alloc_pv, num_pv, i )

load([pwd,filesep,'Data',filesep,'Network Data'])
load([pwd,filesep,'Data',filesep,'Constants'])

Controllable_Inverter=zeros(num_pv,2);
Controllable_Inverter(:,1)=alloc_pv';
Controllable_Inverter(:,2)=0.4;
for j = 1 : num_pv
Cont_Invname(j)={['PV',num2str(j)]};
end

%% Dss file for local control

[fid, ~] = fopen([pwd,filesep,'Data',filesep,'Examined_Network_',num2str(i),'.dss'], 'wt');

fprintf(fid,'\nclear\n');
fprintf(fid,'\n Set DefaultBaseFrequency=50\n');
fprintf(fid,['\nnew circuit.name bus1=',Busname{SW(1)},' baseKv=',num2str(SW(3)),' angle=0 frequency=',num2str(SW(2)),' phases=3 MVAsc1=',num2str(SW(5)),' MVAsc3=',num2str(SW(4)),' x1r1=',num2str(SW(6)),' x0r0=',num2str(SW(7)),'\n']);
fprintf(fid,'\n');

[rows,~]=size(Complist);
for i=1:rows
    type=cell2mat(Complist(i,1));
    switch type

        case 'Line'     
            name=cell2mat(Complist{i,2});
            values=cell2mat(Complist(i,3));
            Rph=num2str(values(6));
            Xph=num2str(values(7));
            Rn=num2str((values(9)-values(6))/3);
            Xn=num2str((values(10)-values(7))/3);
            Cph=num2str(values(8)*10^(-9));
            % Ίσως να μην είναι σωστός ο υπολογισμός του Cn                          
            Cn=num2str((values(11)*10^(-9)-values(8)*10^(-9))/3);
            
            switch  values(3)   

                case 1
                    fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},'.1.2.3.4 bus2=',Busname{values(2)},'.1.2.3.4 length=',...
                    num2str(values(4)),' phases=4 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,' | 0 0 0 ',Rn,' ] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
                    Xph,' | 0 0 0 ',Xn,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,' | 0 0 0 ',Cn,' ] Rg=0 Xg=0\n']);

                case 0
                    fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},' bus2=',Busname{values(2)},' length=',num2str(values(4)),...
                    ' phases=3 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,'] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
                    Xph,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,'] Rg=0 Xg=0\n']);

            end

        case 'Cable'
            name=cell2mat(Complist{i,2});
            values=cell2mat(Complist(i,3));
            name=cell2mat(Complist{i,2});
            values=cell2mat(Complist(i,3));
            Rph=num2str(values(6));
            Xph=num2str(values(7));
            Rn=num2str((values(9)-values(6))/3);
            Xn=num2str((values(10)-values(7))/3);
            Cph=num2str(values(8)*10^(-9));
            % Ίσως να μην είναι σωστός ο υπολογισμός του Cn                          
            Cn=num2str((values(11)*10^(-9)-values(8)*10^(-9))/3);
            
            switch  values(3)   

                case 1
                    fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},'.1.2.3.4 bus2=',Busname{values(2)},'.1.2.3.4 length=',...
                    num2str(values(4)),' phases=4 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,' | 0 0 0 ',Rn,' ] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
                    Xph,' | 0 0 0 ',Xn,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,' | 0 0 0 ',Cn,' ] Rg=0 Xg=0\n']);

                case 0
                    fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},' bus2=',Busname{values(2)},' length=',num2str(values(4)),...
                    ' phases=3 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,'] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
                    Xph,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,'] Rg=0 Xg=0\n']);

            end   

        case 'Transf'
            name=cell2mat(Complist{i,2});
            values=cell2mat(Complist(i,3));
            data_write_tf(fid,Busname,name,values);  
    end
end



for j = 1:length(Compnames)
  values = eval(Compnames{j});
  switch Compnames{j}

            
      case 'PQLoad'
           if ~isempty(values)
              fprintf(fid,'\n!!loads\n');
               for i = 1:length(values(:,1))
                PQLoad(fid,values(i,:),cell2mat(PQLoadname(i)),Busname,phase_con) ;
                fprintf(fid,'\n');
               end
           end
      case 'Gen'
         if ~isempty(values)           
              fprintf(fid,'\n!!fixed generation\n');
               for i = 1:length(values(:,1))
                 Generation(fid,values(i,:),cell2mat(Genname(i)),Busname,phase_con) ;
                 fprintf(fid,'\n');
               end
         end
      case 'Controllable_Inverter'
         if ~isempty(values)           
              fprintf(fid,'\n!!controllable generation\n'); 
               for i = 1:length(values(:,1))
                 Contr_generation(fid,values(i,:),cell2mat(Cont_Invname(i)),Busname) ;
                 fprintf(fid,'\n');
               end
         end

      case 'Bus'
           fprintf(fid,'\n!Reactors\n');    
           for i = 1:length(values(:,1))
             Reactors(fid,values(i,:),Busname) ;  
           end
           fprintf(fid,'\n');
      otherwise
  end
end

if ~Sts.pfalgorithm
    fprintf(fid,'set Algorithm=Normal\n');
else
    fprintf(fid,'set Algorithm=Newton\n');
end

fprintf(fid,['set maxiterations=',num2str(Sts.pfiter),'\n']);
fprintf(fid,['set tolerance=',num2str(Sts.pftol)]);

% closing data file
fclose(fid);


% %% Dss file for Overlaying Control
% Variables;
% 
% Model_File = [Model_File,];
% [fid, message] = fopen([Path.local,Model_File,'_fast.dss'], 'wt');
% 
% fprintf(fid,'\nclear\n');
% fprintf(fid,'\n Set DefaultBaseFrequency=50\n');
% fprintf(fid,['\nnew circuit.name bus1=',Busname{SW(1)},' baseKv=',num2str(SW(3)),' angle=0 frequency=',num2str(SW(2)),' phases=3 MVAsc1=',num2str(SW(5)),' MVAsc3=',num2str(SW(4)),' x1r1=',num2str(SW(6)),' x0r0=',num2str(SW(7)),'\n']);
% fprintf(fid,'\n');
% 
% [rows,~]=size(Complist);
% for i=1:rows
% type=cell2mat(Complist(i,1));
%     switch type
% 
%         case 'Line'     
%             name=cell2mat(Complist{i,2});
%             values=cell2mat(Complist(i,3));
%             Rph=num2str(values(6));
%             Xph=num2str(values(7));
%             Rn=num2str((values(9)-values(6))/3);
%             Xn=num2str((values(10)-values(7))/3);
%             Cph=num2str(values(8)*10^(-9));
%             % Ίσως να μην είναι σωστός ο υπολογισμός του Cn                          
%             Cn=num2str((values(11)*10^(-9)-values(8)*10^(-9))/3);
%          switch  values(3)   
% 
%                        case 1
%                        fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},'.1.2.3.4 bus2=',Busname{values(2)},'.1.2.3.4 length=',...
%                        num2str(values(4)),' phases=4 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,' | 0 0 0 ',Rn,' ] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
%                        Xph,' | 0 0 0 ',Xn,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,' | 0 0 0 ',Cn,' ] Rg=0 Xg=0\n']);
% 
%                        case 0
%                        fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},' bus2=',Busname{values(2)},' length=',num2str(values(4)),...
%                        ' phases=3 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,'] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
%                        Xph,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,'] Rg=0 Xg=0\n']);
%                                
%          
%          end
% 
%         case 'Cable'
%             name=cell2mat(Complist{i,2});
%             values=cell2mat(Complist(i,3));
%             name=cell2mat(Complist{i,2});
%             values=cell2mat(Complist(i,3));
%             Rph=num2str(values(6));
%             Xph=num2str(values(7));
%             Rn=num2str((values(9)-values(6))/3);
%             Xn=num2str((values(10)-values(7))/3);
%             Cph=num2str(values(8)*10^(-9));
%             % Ίσως να μην είναι σωστός ο υπολογισμός του Cn                          
%             Cn=num2str((values(11)*10^(-9)-values(8)*10^(-9))/3);
%          switch  values(3)   
% 
%                        case 1
%                        fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},'.1.2.3.4 bus2=',Busname{values(2)},'.1.2.3.4 length=',...
%                        num2str(values(4)),' phases=4 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,' | 0 0 0 ',Rn,' ] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
%                        Xph,' | 0 0 0 ',Xn,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,' | 0 0 0 ',Cn,' ] Rg=0 Xg=0\n']);
%                        
%                        case 0
%                        fprintf(fid,['new line.',name,' bus1=',Busname{values(1)},' bus2=',Busname{values(2)},' length=',num2str(values(4)),...
%                        ' phases=3 units=km rmatrix=[',Rph,' | 0 ',Rph,' | 0 0 ',Rph,'] xmatrix=[',Xph,' |  0 ',Xph,' | 0 0 ',...
%                        Xph,'] cmatrix=[',Cph,' | 0 ',Cph,' | 0 0 ',Cph,'] Rg=0 Xg=0\n']);
%                                
%          
%          end   
%          
%         case 'Transf'
%         name=cell2mat(Complist{i,2});
%         values=cell2mat(Complist(i,3));
%         data_write_Yy0_tf(fid,Busname,name,values);  
%     end
% end
% 
% 
% 
% for j = 1:length(Compnames)
%   values = eval(Compnames{j});
%   switch Compnames{j}
% 
%             
%       case 'PQLoad'
%            if ~isempty(values)
%               fprintf(fid,'\n!!loads\n');
%                for i = 1:length(values(:,1))
%                  PQLoad(fid,values(i,:),cell2mat(PQLoadname(i)),Busname,phase_con) ;
%                  fprintf(fid,'\n');
%                end
%            end
%       case 'Gen'
%          if ~isempty(values)           
%               fprintf(fid,'\n!!fixed generation\n');
%                for i = 1:length(values(:,1))
%                  Generation(fid,values(i,:),cell2mat(Genname(i)),Busname,phase_con) ;
%                  fprintf(fid,'\n');
%                end
%          end
%       case 'Controllable_Inverter'
%          if ~isempty(values)           
%               fprintf(fid,'\n!!controllable generation\n'); 
%                for i = 1:length(values(:,1))
%                  Contr_generation(fid,values(i,:),cell2mat(Cont_Invname(i)),Busname) ;
%                  fprintf(fid,'\n');
%                end
%          end
%       case 'ZIP'
%          if ~isempty(values)
%             fprintf(fid,'\n!ZIP Loads\n');   
%             for i = 1:length(values(:,1))
%                 ZIP(fid,values(i,:),cell2mat(ZIPname(i)),Busname,phase_con) ;
%                 fprintf(fid,'\n');
%             end
%          end
%       case 'DR'
%          if ~isempty(values)
%           fprintf(fid,'\n!DR units\n');   
%               for i = 1:length(values(:,1))
%                 DR(fid,values(i,:),cell2mat(DRname(i)),Busname,phase_con) ;
%                 fprintf(fid,'\n');
%               end
%          end
%        case 'Bus'
%            fprintf(fid,'\n!Reactors\n');    
%            for i = 1:length(values(:,1))
%              Reactors(fid,values(i,:),Busname) ;  
%            end
%            fprintf(fid,'\n');
%   end
% end
% 
% if ~Sts.pfalgorithm
%     fprintf(fid,'set Algorithm=Normal\n');
% else
%     fprintf(fid,'set Algorithm=Newton\n');
% end
% 
% fprintf(fid,['set maxiterations=',num2str(Sts.pfiter),'\n']);
% fprintf(fid,['set tolerance=',num2str(Sts.pftol)]);
%  % closing data file
% fclose(fid);
% 
% 
end

%% Auxiliary Functions

function PQLoad(fid,PQLoad,name,Busname,connection)

switch PQLoad(4)
    
    case 1
    P=PQLoad(5);
    Q=PQLoad(6);
    case 3
    P=PQLoad(7);
    Q=tan(acos(PQLoad(8)))*P;   
    case 4
    P=PQLoad(9)*abs(PQLoad(10));
    Q=sign(PQLoad(10))*sqrt(PQLoad(9)^2-P^2);
end

if PQLoad(11)==1
    Vmax=PQLoad(12);
    Vmin=PQLoad(13);
else
    Vmax=2;
    Vmin=0.1;
end
con=cell2mat(connection(PQLoad(3)));

                [rows,~]=size(con);
                if rows==3
                   fprintf(fid,['new load.',name,'a',' bus1=',Busname{PQLoad(1)},'.',con(1,:),' phases=1 kV=(',num2str(PQLoad(2)),' 3 sqrt /) kw=',num2str(P/3),...
                   ' kvar=',num2str(Q/3),' model=1 status=fixed Vminpu=',num2str(Vmin),' Vmaxpu=',num2str(Vmax),' \n']);
                   fprintf(fid,['new load.',name,'b',' bus1=',Busname{PQLoad(1)},'.',con(2,:),' phases=1 kV=(',num2str(PQLoad(2)),' 3 sqrt /) kw=',num2str(P/3),...
                   ' kvar=',num2str(Q/3),' model=1 status=fixed Vminpu=',num2str(Vmin),' Vmaxpu=',num2str(Vmax),' \n']);
                   fprintf(fid,['new load.',name,'c',' bus1=',Busname{PQLoad(1)},'.',con(3,:),' phases=1 kV=(',num2str(PQLoad(2)),' 3 sqrt /) kw=',num2str(P/3),...
                   ' kvar=',num2str(Q/3),' model=1 status=fixed Vminpu=',num2str(Vmin),' Vmaxpu=',num2str(Vmax),' \n']);

                else
                   fprintf(fid,['new load.',name,' bus1=',Busname{PQLoad(1)},'.',con,' phases=1 kV=(',num2str(PQLoad(2)),' 3 sqrt /) kw=',num2str(P),...
                   ' kvar=',num2str(Q),' model=1 status=fixed Vminpu=',num2str(Vmin),' Vmaxpu=',num2str(Vmax),' \n']);
  
                end


end



function Generation(fid,Gen,name,Busname,connection)

switch Gen(6)
    case 1
    P=Gen(9);
    Q=Gen(10);
    case 3
    P=Gen(7);
    Q=tan(acos(Gen(8)))*P;
end

con=cell2mat(connection(Gen(2)));

                [rows,~]=size(con);
                if rows==3
                   fprintf(fid,['new generator.',name,'a',' bus1=',Busname{Gen(1)},'.',con(1,:),' phases=1 kV=(',num2str(Gen(3)),' 3 sqrt /) kw=',num2str(P/3),...
                   ' kvar=',num2str(Q/3),' model=1 Vmin=0.1 Vmax=2 \n']);
                   fprintf(fid,['new generator.',name,'b',' bus1=',Busname{Gen(1)},'.',con(2,:),' phases=1 kV=(',num2str(Gen(3)),' 3 sqrt /) kw=',num2str(P/3),...
                   ' kvar=',num2str(Q/3),' model=1 Vmin=0.1 Vmax=2 \n']);
                   fprintf(fid,['new generator.',name,'c',' bus1=',Busname{Gen(1)},'.',con(3,:),' phases=1 kV=(',num2str(Gen(3)),' 3 sqrt /) kw=',num2str(P/3),...
                   ' kvar=',num2str(Q/3),' model=1 Vmin=0.1 Vmax=2 \n']);

                else
                   fprintf(fid,['new generator.',name,' bus1=',Busname{Gen(1)},'.',con,' phases=1 kV=(',num2str(Gen(3)),' 3 sqrt /) kw=',num2str(P),...
                   ' kvar=',num2str(Q),' model=1 Vmin=0.1 Vmax=2 \n']);
  
                end



end

function Contr_generation(fid,Controllable_Inverter,name,Busname)

       fprintf(fid,['new generator.',name,'a',' bus1=',Busname{Controllable_Inverter(1)},'.1.4 phases=1 kV=(',num2str(Controllable_Inverter(2)),' 3 sqrt /) kw=0.001',...
       ' kvar=0 model=1 Vmin=0.1 Vmax=2 \n']);
       fprintf(fid,['new generator.',name,'b',' bus1=',Busname{Controllable_Inverter(1)},'.2.4 phases=1 kV=(',num2str(Controllable_Inverter(2)),' 3 sqrt /) kw=0.001',...
       ' kvar=0 model=1 Vmin=0.1 Vmax=2 \n']);
       fprintf(fid,['new generator.',name,'c',' bus1=',Busname{Controllable_Inverter(1)},'.3.4 phases=1 kV=(',num2str(Controllable_Inverter(2)),' 3 sqrt /) kw=0.001',...
       ' kvar=0 model=1 Vmin=0.1 Vmax=2 \n']);
end

function Reactors(fid,Bus,Busname)
       if Bus(3)==1
           fprintf(fid,['new Reactor.reac',Busname{Bus(1)},' phases=1 bus=',Busname{Bus(1)},'.4 R=',num2str(Bus(4)),' X=',num2str(Bus(5)),' \n']);
       end
end


function data_write_tf(fid,Busname,name,values)

fprintf(fid,'\n!!transformer\n');
if (values(13)==values(14) && values(15)==values(16))
    BusMV = Busname{values(1)};
    BusLV = Busname{values(2)};
else
    BusMV = Busname{values(1)};
    BusLV = Busname{values(2)};
    GhostBus=[name,'ghostbus'];
    % calculate Zb
    Zb=((values(3))^2)/values(5);
    % (R0=R1) but X0<>X1
    if (values(13)==values(14))
        X=values(15)-values(16);
        Xs=(2*X*Zb)/3;
        Xm=((0-X)*Zb)/3;
        Xi=Xm+0.0001;
        fprintf(fid,['new reactor.PosSeq Bus1=',BusMV,' Bus2=',GhostBus,' \n']);
        fprintf(fid,['~ xmatrix=[',num2str(Xs),' | ',num2str(Xm),' ',num2str(Xs),' | ',num2str(Xi),' ',num2str(Xm),' ',num2str(Xs),'] \n']);
        fprintf(fid,['~ rmatrix=[0 | 0 0 | 0 0 0.0001]',' \n']);
    % (X0=X1) but R0<>R1
    elseif (values(15)==values(16))

        R=values(13)-values(14);
        Rs=(2*R*Zb)/3;
        Rm=((0-R)*Zb)/3;
        Ri=Rm+0.0001;
        fprintf(fid,['new reactor.PosSeq Bus1=',BusMV,' Bus2=',GhostBus,' \n']);
        fprintf(fid,['~ rmatrix=[',num2str(Rs),' | ',num2str(Rm),' ',num2str(Rs),' | ',num2str(Ri),' ',num2str(Rm),' ',num2str(Rs),'] \n']);
        fprintf(fid,['~ xmatrix=[0 | 0 0 | 0 0 0.0001]',' \n']);
    else
        X=values(15)-values(16);
        Xs=(2*X*Zb)/3;
        Xm=((0-X)*Zb)/3;
        Xi=Xm+0.0001;
        R=values(13)-values(14);
        Rs=(2*R*Zb)/3;
        Rm=((0-R)*Zb)/3;
        Ri=Rm+0.0001;
        fprintf(fid,['new reactor.PosSeq Bus1=',BusMV,' Bus2=',GhostBus,' \n']);
        fprintf(fid,['~ xmatrix=[',num2str(Xs),' | ',num2str(Xm),' ',num2str(Xs),' | ',num2str(Xi),' ',num2str(Xm),' ',num2str(Xs),'] \n']);
        fprintf(fid,['~ rmatrix=[',num2str(Rs),' | ',num2str(Rm),' ',num2str(Rs),' | ',num2str(Ri),' ',num2str(Rm),' ',num2str(Rs),'] \n']);
    end
end

    
switch values(6)

    % Yy0
    case 1
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2]',...
                ' \n~ conns=[wye wye] \n~kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

    % Yyn0
    case 2
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end   

    % YNy0
    case 3
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusnLV,'.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    % YNyn0    
    case 4
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.4]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end   

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end


    % Yd1
    case 5
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

    % YNd1 
    case 6
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    % Yd5
    case 7
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end 

    % YNd5
    case 8
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.3.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.1.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.2.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    % Yd11
    case 9
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    % YNd11
    case 10
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.3]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.1]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.2]',...
                ' \n~ conns=[wye delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    % Dy1
    case 11
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.3',' ',BusLV,'.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.1',' ',BusLV,'.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \n~new transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.2',' ',BusLV,'.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.3',' ',BusLV,'.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.1',' ',BusLV,'.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.2',' ',BusLV,'.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    % Dyn1
    case 12
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.3',' ',BusLV,'.1.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.1',' ',BusLV,'.2.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.2',' ',BusLV,'.3.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.3',' ',BusLV,'.1.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.1',' ',BusLV,'.2.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.2',' ',BusLV,'.3.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %Dy5
    case 13
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.0.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.0.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.0.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.0.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.0.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!! phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.0.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Dyn5
    case 14
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.4.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.4.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.4.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.4.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.4.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.4.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %Dy11
    case 15
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Dyn11
    case 16
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.4]',...
                ' \n~ conns=[delta wye] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %Yz5
    case 17
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.4.1',' ',BusLV,'.6.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.5.2',' ',BusLV,'.4.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.6.3',' ',BusLV,'.5.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.4.1',' ',BusLV,'.6.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.5.2',' ',BusLV,'.4.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.6.3',' ',BusLV,'.5.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

    %Yzn5
    case 18
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.5.1',' ',BusLV,'.7.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.6.2',' ',BusLV,'.5.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.7.3',' ',BusLV,'.6.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.5.1',' ',BusLV,'.7.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.6.2',' ',BusLV,'.5.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.7.3',' ',BusLV,'.6.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %YNz5
    case 19
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.4.1',' ',BusLV,'.6.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.5.2',' ',BusLV,'.4.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.6.3',' ',BusLV,'.5.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.4.1',' ',BusLV,'.6.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.5.2',' ',BusLV,'.4.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.6.3',' ',BusLV,'.5.0]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    %YNzn5
    case 20
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.5.1',' ',BusLV,'.7.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.6.2',' ',BusLV,'.5.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.7.3',' ',BusLV,'.6.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.5.1',' ',BusLV,'.7.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.6.2',' ',BusLV,'.5.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.7.3',' ',BusLV,'.6.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    %Yy6
    case 21
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~buses=[',BusMV,'.1.0',' ',BusLV,'.0.1]',...
                ' \n~conns=[wye wye] \n~kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~buses=[',BusMV,'.2.0',' ',BusLV,'.0.2]',...
                ' \n~conns=[wye wye] \n~kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~buses=[',BusMV,'.3.0',' ',BusLV,'.0.3]',...
                ' \n~conns=[wye wye] \n~kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.0.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.0.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.0.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Yyn6
    case 22
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.4.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.4.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.4.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.4.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.4.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.4.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %YNy6
    case 23
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.0.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.0.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.0.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.0.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.0.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.0.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    %YNyn6
    case 24
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.4.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.4.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.4.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.4.1]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.4.2]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.4.3]',...
                ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    %Dd0
    case 25
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.2]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.3]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.1]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.2]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.3]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.1]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Dd6
    case 26
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.2.1]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.3.2]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.1.3]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.2.1]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.3.2]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.1.3]',...
                ' \n~ conns=[delta delta] \n~ kvs=[',num2str(values(3)),' ',num2str(values(4)),'] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' %%loadloss=',num2str(values(14)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Dz0
    case 27
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.6',' ',BusLV,'.0.4]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.4',' ',BusLV,'.0.5]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.5',' ',BusLV,'.0.6]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.6',' ',BusLV,'.0.4]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.4',' ',BusLV,'.0.5]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.5',' ',BusLV,'.0.6]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Dzn0
    case 28
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.7',' ',BusLV,'.4.5]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.5',' ',BusLV,'.4.6]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.6',' ',BusLV,'.4.7]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.1.7',' ',BusLV,'.4.5]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.2.5',' ',BusLV,'.4.6]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.3.6',' ',BusLV,'.4.7]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %Dz6
    case 29
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.5.0',' ',BusLV,'.4.1]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.6.0',' ',BusLV,'.5.2]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.4.0',' ',BusLV,'.6.3]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.5.0',' ',BusLV,'.4.1]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.6.0',' ',BusLV,'.5.2]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.4.0',' ',BusLV,'.6.3]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

    %Dzn6
    case 30
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.6.4',' ',BusLV,'.5.1]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.7.4',' ',BusLV,'.6.2]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.5.4',' ',BusLV,'.7.3]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.2',' ',BusLV,'.6.4',' ',BusLV,'.5.1]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.3',' ',BusLV,'.7.4',' ',BusLV,'.6.2]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.1',' ',BusLV,'.5.4',' ',BusLV,'.7.3]'...
                ' \n~ conns=[delta delta delta] \n~ kvs=[',num2str(values(3)),' (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]'...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %Yz11
    case 31
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.4',' ',BusLV,'.0.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.5',' ',BusLV,'.0.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.6',' ',BusLV,'.0.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.4',' ',BusLV,'.0.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.5',' ',BusLV,'.0.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.6',' ',BusLV,'.0.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

    %Yzn11
    case 32
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.5',' ',BusLV,'.4.7]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.6',' ',BusLV,'.4.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.7',' ',BusLV,'.4.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.0',' ',BusLV,'.1.5',' ',BusLV,'.4.7]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.0',' ',BusLV,'.2.6',' ',BusLV,'.4.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.0',' ',BusLV,'.3.7',' ',BusLV,'.4.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

    %YNz11
    case 33
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.4',' ',BusLV,'.0.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.5',' ',BusLV,'.0.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.6',' ',BusLV,'.0.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.4',' ',BusLV,'.0.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.5',' ',BusLV,'.0.4]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.6',' ',BusLV,'.0.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end

    %YNzn11
    case 34
        switch values(9)

            case 0
                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.5',' ',BusLV,'.4.7]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.6',' ',BusLV,'.4.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.7',' ',BusLV,'.4.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);


            case 1
                mintap=1-(((values(10))/2)*(values(12)/100));
                maxtap=1+(((values(10))/2)*(values(12)/100));
                actualtap=1+((values(11))*(values(12)/100));

                fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=3 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.5',' ',BusLV,'.4.7]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=3 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.6',' ',BusLV,'.4.5]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);

                fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=3 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.7',' ',BusLV,'.4.6]',...
                ' \n~ conns=[wye delta delta] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 /) (',num2str(values(4)),' 3 /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
                ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(16)),' Xht=',num2str(values(16)),' Xlt=0 %%Rs=[(',num2str(values(14)),' 2 /) (',num2str(values(14)),' 4 /) (',num2str(values(14)),' 4 /)] %%noloadloss=',num2str(values(17)),' Sub=Yes'...
                ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
                ' %%imag=',num2str(values(18)),' \n\n']);
        end

        switch values(7)
            case 1
                fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
        end

        switch values(8)
            case 1
                fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
        end


end
end
          
% function data_write_Yy0_tf(fid,Busname,name,values)
% 
% fprintf(fid,'\n!!Yy0transformer-Created for fast control implementation\n');
% BusMV = Busname{values(1)};
% BusLV = Busname{values(2)};
% 
% switch values (6)
% 
%     % Yy0, Yd1, Yd5, Yd11, Dy1, Dy5, Dy11, Yz5, Yy6, Dd0, Dd6, Dz0, Dz6, Yz11
%     % **** MODELED AS Yy0 ****
% 
%     case {1,5,7,9,11,13,15,17,21,25,26,27,29,31}
%         switch values (9)
% 
%             case 0
% 
%                 fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%             case 1
% 
%                 mintap=1-(((values(10))/2)*(values(12)/100));
%                 maxtap=1+(((values(10))/2)*(values(12)/100));
%                 actualtap=1+((values(11))*(values(12)/100));
% 
%                 fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2]',...
%                 ' \n~ conns=[wye wye] \n~kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%         end 
% 
%     % Yyn0, Dyn1, Dyn5, Dyn11, Yzn5, Yyn6, Dzn0, Dzn6, Yzn11    
%     % **** MODELED AS Yyn0 ****
% 
%     case {2,12,14,16,18,22,28,30,32}
% 
%         switch values(9)
% 
%             case 0
%                 fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%             case 1
%                 mintap=1-(((values(10))/2)*(values(12)/100));
%                 maxtap=1+(((values(10))/2)*(values(12)/100));
%                 actualtap=1+((values(11))*(values(12)/100));
% 
%                 fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1',' ',BusLV,'.1.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2',' ',BusLV,'.2.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3',' ',BusLV,'.3.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%         end 
% 
%         switch values(7)
%             case 1
%                 fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
%         end   
% 
%         %    YNy0, YNd1, YNd5, YNd11, YNz5, YNy6, YNz11
%         % **** MODELED AS YNy0 ****
%         case {3,6,8,10,19,23,33}  
%             switch values(9)
% 
%                 case 0
%                     fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1]',...
%                     ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                     ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                     fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusnLV,'.2]',...
%                     ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                     ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                     fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3]',...
%                     ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                     ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 case 1
%                     mintap=1-(((values(10))/2)*(values(12)/100));
%                     maxtap=1+(((values(10))/2)*(values(12)/100));
%                     actualtap=1+((values(11))*(values(12)/100));
% 
%                     fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1]',...
%                     ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                     ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                     ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                     ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                     fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2]',...
%                     ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                     ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                     ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                     ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                     fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3]',...
%                     ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                     ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                     ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                     ' %%imag=',num2str(values(18)),' \n\n']);
% 
%             end 
% 
%             switch values(8)
%                 case 1
%                     fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
%             end
% 
%     % YNyn0, YNzn5, YNyn6, YNzn11
%     % **** MODELED AS YNyn0 ****
%     case {4,20,24,34}    
%         switch values(9)
% 
%             case 0
%                 fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes %%imag=',num2str(values(18)),' \n\n']);
% 
%             case 1
%                 mintap=1-(((values(10))/2)*(values(12)/100));
%                 maxtap=1+(((values(10))/2)*(values(12)/100));
%                 actualtap=1+((values(11))*(values(12)/100));
% 
%                 fprintf(fid,['!!phase 1 \nnew transformer.',name,'ph1 phases=1 windings=2 \n~ buses=[',BusMV,'.1.4',' ',BusLV,'.1.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 2 \nnew transformer.',name,'ph2 phases=1 windings=2 \n~ buses=[',BusMV,'.2.4',' ',BusLV,'.2.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%                 fprintf(fid,['!!phase 3 \nnew transformer.',name,'ph3 phases=1 windings=2 \n~ buses=[',BusMV,'.3.4',' ',BusLV,'.3.4]',...
%                 ' \n~ conns=[wye wye] \n~ kvs=[(',num2str(values(3)),' 3 sqrt /) (',num2str(values(4)),' 3 sqrt /)] \n~ kvas=[(',num2str(values(5)),' 3 /) (',num2str(values(5)),' 3 /)]',...
%                 ' \n~ taps=[',num2str(actualtap),',1] \n~ Xhl=',num2str(values(15)),' %%loadloss=',num2str(values(13)),' %%noloadloss=',num2str(values(17)),' Sub=Yes'...
%                 ' \n~ Maxtap=',num2str(maxtap),' Mintap=',num2str(mintap),' Numtap=',num2str(values(10)),...
%                 ' %%imag=',num2str(values(18)),' \n\n']);
% 
%         end 
% 
%         switch values(7)
%             case 1
%                 fprintf(fid,['new Reactor.reac',BusLV,' phases=1 bus=',BusLV,'.4 R=',num2str(values(21)),' X=',num2str(values(22)),' \n']); 
%         end   
% 
% 
%         switch values(8)
%             case 1
%                 fprintf(fid,['new Reactor.reac',BusMV,' phases=1 bus=',BusMV,'.4 R=',num2str(values(19)),' X=',num2str(values(20)),' \n']); 
%         end
% 
% end
% end




